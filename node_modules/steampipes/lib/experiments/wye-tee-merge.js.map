{
  "version": 3,
  "file": "wye-tee-merge.js",
  "sourceRoot": "../..",
  "sources": [
    "src/experiments/wye-tee-merge.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'STEAMPIPES/WYE-TEE-MERGE'\n# log                       = CND.get_logger 'plain',     badge\n# info                      = CND.get_logger 'info',      badge\n# whisper                   = CND.get_logger 'whisper',   badge\n# alert                     = CND.get_logger 'alert',     badge\ndebug                     = CND.get_logger 'debug',     badge\n# warn                      = CND.get_logger 'warn',      badge\n# help                      = CND.get_logger 'help',      badge\n# urge                      = CND.get_logger 'urge',      badge\n# echo                      = CND.echo.bind CND\n{ jr }                    = CND\n# mux                       = require 'pull-mux' ### https://github.com/nichoth/pull-mux ###\ndefer                     = setImmediate\n\n#-----------------------------------------------------------------------------------------------------------\n@$tee = ( a, b ) ->\n  switch ( arity = arguments.length )\n    when 1 then return @_$tee_without_filter  a\n    when 2 then return @_$tee_with_filter     a, b\n  throw new Error \"Âµ93002 expected 1 or 2 arguments, got #{arity}\"\n\n#-----------------------------------------------------------------------------------------------------------\n@_$tee_without_filter = ( bystream ) ->\n  ### Given a `bystream`, send a data down both the mainstream and the bystream. This allows e.g. to log all\n  events to a file sink while continuing to process the same data in the mainline. **NB** that in\n  contradistinction to `pull-tee`, you can only divert to a single by-stream with each call to `PS.$tee` ###\n  return ( require 'pull-tee' ) bystream\n\n#-----------------------------------------------------------------------------------------------------------\n@_$tee_with_filter = ( filter, bystream ) ->\n  ### Given a `filter` function and a `bystream`, send only data `d` for which `filter d` returns true down\n  the bystream. No data will be taken out of the mainstream. ###\n  return @_$tee_without_filter @pull ( @$filter filter ), bystream\n\n#-----------------------------------------------------------------------------------------------------------\n@$bifurcate = ( filter, bystream ) ->\n  ### Given a `filter` function and a `bystream`, send all data `d` either down the bystream if `filter d`\n  returns true, or down the mainstream otherwise, causing a disjunct bifurcation of the data stream. ###\n  byline    = []\n  pipeline  = []\n  byline.push @$ ( d, send ) -> send d[ 1 ] if d[ 0 ]\n  byline.push bystream\n  pipeline.push @$ ( d, send ) -> send [ ( filter d ), d, ]\n  pipeline.push @_$tee_without_filter @pull byline...\n  pipeline.push @$ ( d, send ) -> send d[ 1 ] if not d[ 0 ]\n  return @pull pipeline...\n\n#-----------------------------------------------------------------------------------------------------------\n@new_merged_source = ( sources... ) ->\n  #.........................................................................................................\n  $_mux = ( sources... ) =>\n    R = {}\n    R[ idx ] = source for source, idx in sources\n    return mux R\n  #.........................................................................................................\n  $_demux = => @$map ( [ k, v, ] ) -> v\n  #.........................................................................................................\n  pipeline  = []\n  pipeline.push $_mux sources...\n  pipeline.push $_demux()\n  return @pull pipeline...\n\n#-----------------------------------------------------------------------------------------------------------\n@$wye = ( stream, settings ) ->\n  new_duplex_pair     = require 'pull-pair/duplex'\n  settings            = { defer: false, settings..., }\n  [ client, server, ] = new_duplex_pair()\n  serverline          = []\n  serverline.push @new_merged_source server, stream\n  serverline.push @$defer() if settings.defer\n  serverline.push server\n  @pull serverline...\n  return client\n\n#-----------------------------------------------------------------------------------------------------------\n@leapfrog = ( test, transform ) ->\n  ### Given a `test` function (which accepts a single argument) and a `transform`, make it so that whenever\n  `test d` returns `true`, data `d` will be taken out of the stream and 'jump over' the transform, as it\n  were. Downstream transforms will still receive all data items, including the leapfrogging ones, but the\n  stream as it is visible to the `transform` will be thinned out. ###\n  #.........................................................................................................\n  last      = Symbol 'last'\n  bysource  = @new_push_source()\n  pipeline  = []\n  pipeline.push @$defer()\n  pipeline.push @$ { last, }, ( d, send ) ->\n    if d is last        then  bysource.end()\n    else if ( test d )  then  bysource.send d\n    else                      send d\n    return null\n  pipeline.push transform\n  pipeline.push @$wye bysource\n  #.........................................................................................................\n  return @pull pipeline...\n\n\n\n"
  ]
}