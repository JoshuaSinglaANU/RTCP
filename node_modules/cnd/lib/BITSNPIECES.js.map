{
  "version": 3,
  "file": "BITSNPIECES.js",
  "sourceRoot": "..",
  "sources": [
    "src/BITSNPIECES.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n\n############################################################################################################\nnjs_path                  = require 'path'\nnjs_fs                    = require 'fs'\nnjs_util                  = require 'util'\nrpr                       = njs_util.inspect\nCND                       = require './main'\nPATH                      = require 'path'\n@flatten                  = ( x, depth = Infinity ) -> x.flat depth\n\n#-----------------------------------------------------------------------------------------------------------\n@equals = ( P... ) -> ( require './jkroso-equals' ) P...\n\n#-----------------------------------------------------------------------------------------------------------\n@is_empty = ( x ) ->\n  return ( x.length is 0 ) if x.length?\n  return ( x.size   is 0 ) if x.size?\n  throw new Error \"unable to determine length of a #{CND.type_of x}\"\n\n#-----------------------------------------------------------------------------------------------------------\n@jr     = JSON.stringify\n@assign = Object.assign\n\n#-----------------------------------------------------------------------------------------------------------\n@here_abspath             = ( dirname, P... ) -> PATH.resolve   dirname,        P...\n@cwd_abspath              = ( P...          ) -> PATH.resolve   process.cwd(),  P...\n@cwd_relpath              = ( P...          ) -> PATH.relative  process.cwd(),  P...\n\n#-----------------------------------------------------------------------------------------------------------\n@ensure_directory = ( path ) -> new Promise ( resolve, reject ) =>\n  ( require 'mkdirp' ) path, ( error ) =>\n    throw error if error?\n    resolve()\n\n#-----------------------------------------------------------------------------------------------------------\n@copy = ( P... ) ->\n  return switch type = @type_of P[ 0 ]\n    when 'pod'  then @assign {}, P...\n    when 'list' then @assign [], P...\n    else throw new Error \"µ09231 unable to copy a #{type}\"\n\n#-----------------------------------------------------------------------------------------------------------\n@deep_copy = ( P... ) -> ( require './universal-copy' ) P...\n\n#-----------------------------------------------------------------------------------------------------------\nnumber_formatter = new Intl.NumberFormat 'en-US'\n@format_number = ( x ) -> number_formatter.format x\n\n#-----------------------------------------------------------------------------------------------------------\n@escape_regex = ( text ) ->\n  ### Given a `text`, return the same with all regular expression metacharacters properly escaped. Escaped\n  characters are `[]{}()*+?-.,\\^$|#` plus whitespace. ###\n  #.........................................................................................................\n  return text.replace /[-[\\]{}()*+?.,\\\\\\/^$|#\\s]/g, \"\\\\$&\"\n\n#-----------------------------------------------------------------------------------------------------------\n@escape_html = ( text ) ->\n  ### Given a `text`, return the same with all characters critical in HTML (`&`, `<`, `>`) properly\n  escaped. ###\n  R = text\n  R = R.replace /&/g, '&amp;'\n  R = R.replace /</g, '&lt;'\n  R = R.replace />/g, '&gt;'\n  #.........................................................................................................\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@find_all = ( text, matcher ) ->\n  ### `CND.find_all` expects a `text` and a `matcher` (which must be a RegExp object); it returns a\n  (possibly empty) list of all matching parts in the text. If `matcher` does not have the `g` (global) flag\n  set, a new RegExp object will be cloned behind the scenes, so passsing in a regular expression with `g`\n  turned on may improve performance.\n\n  With thanks to http://www.2ality.com/2013/08/regexp-g.html,\n  http://www.2ality.com/2011/04/javascript-overview-of-regular.html.\n  ###\n  unless ( Object::toString.call matcher is '[object RegExp]' ) and matcher.global\n    flags   = if matcher.multiline then 'gm' else 'g'\n    flags  += 'i' if matcher.ignoreCase\n    flags  += 'y' if matcher.sticky\n    matcher = ( new RegExp matcher.source, flags )\n  throw new Error \"matcher must be a RegExp object with global flag set\" unless matcher.global\n  matcher.lastIndex = 0\n  return ( text.match matcher ) ? []\n\n#===========================================================================================================\n# UNSORTING\n#-----------------------------------------------------------------------------------------------------------\n@shuffle = ( list, ratio = 1 ) ->\n  ### Shuffles the elements of a list randomly. After the call, the elements of will be—most of the time—\n  be reordered (but this is not guaranteed, as there is a realistic probability for recurrence of orderings\n  with short lists).\n\n  This is an implementation of the renowned Fisher-Yates algorithm, but with a twist: You may pass in a\n  `ratio` as second argument (which should be a float in the range `0 <= ratio <= 1`); if set to a value\n  less than one, a random number will be used to decide whether or not to perform a given step in the\n  shuffling process, so lists shuffled with zero-ish ratios will show less disorder than lists shuffled with\n  a one-ish ratio.\n\n  Implementation gleaned from http://stackoverflow.com/a/962890/256361. ###\n  #.........................................................................................................\n  return list if ( this_idx = list.length ) < 2\n  return @_shuffle list, ratio, Math.random, @random_integer.bind @\n\n#-----------------------------------------------------------------------------------------------------------\n@get_shuffle = ( seed_0 = 0, seed_1 = 1 ) ->\n  ### This method works similar to `get_rnd`; it accepts two `seed`s which are used to produce random number\n  generators and returns a predictable shuffling function that accepts arguments like Bits'N'Pieces\n  `shuffle`. ###\n  rnd             = @get_rnd      seed_0\n  random_integer  = @get_rnd_int  seed_1\n  return ( list, ratio = 1 ) => @_shuffle list, ratio, rnd, random_integer\n\n#-----------------------------------------------------------------------------------------------------------\n@_shuffle = ( list, ratio, rnd, random_integer ) ->\n  #.........................................................................................................\n  return list if ( this_idx = list.length ) < 2\n  #.........................................................................................................\n  loop\n    this_idx += -1\n    return list if this_idx < 1\n    if ratio >= 1 or rnd() <= ratio\n      # return list if this_idx < 1\n      that_idx = random_integer 0, this_idx\n      [ list[ that_idx ], list[ this_idx ] ] = [ list[ this_idx ], list[ that_idx ] ]\n  #.........................................................................................................\n  return list\n\n\n\n#===========================================================================================================\n# RANDOM NUMBERS\n#-----------------------------------------------------------------------------------------------------------\n### see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number ###\n@MIN_SAFE_INTEGER = -( 2 ** 53 ) - 1\n@MAX_SAFE_INTEGER = +( 2 ** 53 ) - 1\n\n#-----------------------------------------------------------------------------------------------------------\n@random_number = ( min = 0, max = 1 ) ->\n  ### Return a random number between min (inclusive) and max (exclusive).\n  From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random\n  via http://stackoverflow.com/a/1527820/256361. ###\n  return Math.random() * ( max - min ) + min\n\n#-----------------------------------------------------------------------------------------------------------\n@integer_from_normal_float = ( x, min = 0, max = 2 ) ->\n  ### Given a 'normal' float `x` so that `0 <= x < 1`, return an integer `n` so that `min <= n < min`. ###\n  return ( Math.floor x * ( max - min ) ) + min\n\n#-----------------------------------------------------------------------------------------------------------\n@random_integer = ( min = 0, max = 2 ) ->\n  ### Return a random integer between min (inclusive) and max (inclusive).\n  From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random\n  via http://stackoverflow.com/a/1527820/256361. ###\n  return @integer_from_normal_float Math.random(), min, max\n\n#-----------------------------------------------------------------------------------------------------------\n@get_rnd_int = ( seed = 1, delta = 1 ) ->\n  ### Like `get_rnd`, but returns a predictable random integer generator. ###\n  rnd = @get_rnd seed, delta\n  return ( min = 0, max = 1 ) => @integer_from_normal_float rnd(), min, max\n\n#-----------------------------------------------------------------------------------------------------------\n@get_rnd = ( seed = 1, delta = 1 ) ->\n  ### This method returns a simple deterministic pseudo-random number generator—basically like\n  `Math.random`, but (1) very probably with a much worse distribution of results, and (2) with predictable\n  series of numbers, which is good for some testing scenarios. You may seed this method by passing in a\n  `seed` and a `delta`, both of which must be non-zero numbers; the ensuing series of calls to the returned\n  method will then always result in the same series of numbers. Here is a usage example that also shows how\n  to reset the generator:\n\n      CND = require 'cnd'\n      rnd = CND.get_rnd() # or, say, `rnd = CND.get_rnd 123, 0.5`\n      log rnd() for idx in [ 0 .. 5 ]\n      log()\n      rnd.reset()\n      log rnd() for idx in [ 0 .. 5 ]\n\n  Please note that there are no strong guarantees made about the quality of the generated values except the\n  (1) deterministic repeatability, (2) boundedness, and (3) 'apparent randomness'. Do **not** use this for\n  cryptographic purposes. ###\n  #.........................................................................................................\n  R = ->\n    R._idx  += 1\n    x       = ( Math.sin R._s ) * 10000\n    R._s    += R._delta\n    return x - Math.floor x\n  #.........................................................................................................\n  R.reset = ( seed, delta ) ->\n    ### Reset the generator. After calling `rnd.reset` (or `rnd.seed` with the same arguments), ensuing calls\n    to `rnd` will always result in the same sequence of pseudo-random numbers. ###\n    seed   ?= @._seed\n    delta  ?= @._delta\n    #.......................................................................................................\n    validate_isa_number seed\n    validate_isa_number delta\n    #.......................................................................................................\n    throw new Error \"seed should not be zero\"  unless seed  != 0\n    throw new Error \"delta should not be zero\" unless delta != 0\n    #.......................................................................................................\n    R._s     = seed\n    R._seed  = seed\n    R._delta = delta\n    R._idx   = -1\n    return null\n  #.........................................................................................................\n  R.reset seed, delta\n  #.........................................................................................................\n  return R\n\n\n#-----------------------------------------------------------------------------------------------------------\n### TAINT code duplication (to avoid dependency on CoffeeNode Types). ###\nvalidate_isa_number = ( x ) ->\n  unless ( Object::toString.call x ) == '[object Number]' and isFinite x\n    throw \"expected a number, got #{( require 'util' ).inspect x}\"\n\n\n#===========================================================================================================\n# PODs\n#-----------------------------------------------------------------------------------------------------------\n@pluck = ( x, name, fallback ) ->\n  ### Given some object `x`, a `name` and a `fallback`, return the value of `x[ name ]`, or, if it does not\n  exist, `fallback`. When the method returns, `x[ name ]` has been deleted. ###\n  if x[ name ]?\n    R = x[ name ]\n    delete x[ name ]\n  else\n    R = fallback\n  return R\n\n\n#===========================================================================================================\n# ROUTES\n#-----------------------------------------------------------------------------------------------------------\n@get_parent_routes = ( route ) ->\n  R = []\n  #.........................................................................................................\n  loop\n    R.push route\n    break if route.length is 0 or route is '/'\n    route = njs_path.dirname route\n  #.........................................................................................................\n  return R\n\n\n#===========================================================================================================\n# CALLER LOCATION\n#-----------------------------------------------------------------------------------------------------------\n@get_V8_CallSite_objects = ( error = null ) ->\n  ### Save original Error.prepareStackTrace ###\n  prepareStackTrace_original = Error.prepareStackTrace\n  #.........................................................................................................\n  Error.prepareStackTrace = ( ignored, stack ) -> return stack\n  error                  ?= new Error()\n  R                       = error.stack\n  #.........................................................................................................\n  ### Restore original Error.prepareStackTrace ###\n  Error.prepareStackTrace = prepareStackTrace_original\n  #.........................................................................................................\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@get_caller_info_stack = ( delta = 0, error = null, limit = Infinity, include_source = no ) ->\n  ### Return a list of PODs representing information about the call stack; newest items will be closer\n  to the start ('top') of the list.\n\n  `delta` represents the call distance of the site the inquirer is interested about, relative to the\n  *inquirer*; this will be `0` if that is the very line where the call originated from, `1` in case another\n  function is called to collect this information, and so on.\n\n  A custom error will be produced and analyzed (with a suitably adjusted value for `delta`) in case no\n  `error` has been given. Often, one will want to use this facility to see what the source for a caught\n  error looks like; in that case, just pass in the caught `error` object along with a `delta` of (typically)\n  `0` (because the error really originated where the problem occurred).\n\n  It is further possible to cut down on the amount of data returned by setting `limit` to a smallish\n  number; entries too close (with a stack index smaller than `delta`) or too far from the interesting\n  point will be omitted.\n\n  When `include_source` is `true`, an attempt will be made to open each source file, read its contents,\n  split it into lines, and include the indicated line in the respective entry. Note that this is currently\n  done in a very stupid, blocking, and non-memoizing way, so try not to do that if your stack trace is\n  hundreds of lines long and includes megabyte-sized sources.\n\n  Also see `get_caller_info`, which should be handy if you do not need an entire stack but just a single\n  targetted entry.\n\n  Have a look at https://github.com/loveencounterflow/guy-test to see how to use the BNP caller info\n  methods to copy with error locations in an asynchronous world. ###\n  #.........................................................................................................\n  delta      += +2 unless error?\n  call_sites  = @get_V8_CallSite_objects error\n  R           = []\n  #.........................................................................................................\n  for cs, idx in call_sites\n    continue if delta? and idx < delta\n    break if R.length >= limit\n    entry =\n      'function-name':    cs.getFunctionName()\n      'method-name':      cs.getMethodName()\n      'route':            cs.getFileName()\n      'line-nr':          cs.getLineNumber()\n      'column-nr':        cs.getColumnNumber()\n    entry[ 'source' ] = @_source_line_from_caller_info entry if include_source\n    R.push entry\n  #.........................................................................................................\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@get_caller_info = ( delta = 0, error = null, include_source = no ) ->\n  R = null\n  while delta >= 0 and not R?\n    R       = ( @get_caller_info_stack delta, error, 1, include_source )[ 0 ]\n    delta  += -1\n  # console.log '©3cc0i', rpr R\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@_source_line_from_caller_info = ( info ) ->\n  route           = info[ 'route'   ]\n  line_nr         = info[ 'line-nr' ]\n  try\n    source_lines    = ( njs_fs.readFileSync route, encoding: 'utf-8' ).split /\\r?\\n/\n    R               = source_lines[ line_nr - 1 ]\n  catch error\n    R               = null\n  return R\n\n\n#===========================================================================================================\n# ID CREATION\n#-----------------------------------------------------------------------------------------------------------\n@create_id = ( values, length ) ->\n  ### Given a number of `values` and a `length`, return an ID with `length` hexadecimal digits (`[0-9a-f]`)\n  that deterministically depends on the input but can probably not reverse-engeneered to yield the input\n  values. This is in no way meant to be cryptographically strong, just arbitrary enough so that we have a\n  convenient method to derive an ID with little chance of overlap given different inputs. **Note** It is\n  certainly possible to use this method (or `id_from_text`) to create a hash from a password to be stored in\n  a DB. Don't do this. Use `bcrypt` or similar best-practices for password storage. Again, the intent of\n  the BITSNPIECES ID utilities is *not* to be 'crypto-safe'; its intent is to give you a tool for generating\n  repetition-free IDs. ###\n  return @id_from_text ( ( rpr value for value in values ).join '-' ), length\n\n#-----------------------------------------------------------------------------------------------------------\n@create_random_id = ( values, length ) ->\n  ### Like `create_id`, but with an extra random factor built in that should exclude that two identical\n  outputs are ever returned for any two identical inputs. Under the assumption that two calls to this\n  method are highly unlikely two produce an identical pair `( 1 * new Date(), Math.random() )` (which could\n  only happen if `Math.random()` returned the same number again *within the same clock millisecond*), and\n  assuming you are using a reasonable value for `length` (i.e., say, `7 < length < 20`), you should never\n  see the same ID twice. ###\n  values.push 1 * new Date() * Math.random()\n  return @create_id values, length\n\n#-----------------------------------------------------------------------------------------------------------\n@get_create_rnd_id = ( seed, delta ) ->\n  ### Given an optional `seed` and `delta`, returns a function that will create pseudo-random IDs similar to\n  the ones `create_random_id` returns; however, the Bits'n'Pieces `get_rnd` method is used to obtain a\n  repeatable random number generator so that ID sequences are repeatable. The underlying PRNG is exposed as\n  `fn.rnd`, so `fn.rnd.reset` may be used to start over.\n\n  **Use Case Example**: The below code demonstrates the interesting properties of the method returned by\n  `get_create_rnd_id`: **(1)** we can seed the PRNG with numbers of our choice, so we get a chance to create\n  IDs that are unlikely to be repeated by other people using the same software, even when later inputs (such\n  as the email adresses shown here) happen to be the same. **(2)** Calling the ID generator with three\n  diffferent user-specific inputs, we get three different IDs, as expected. **(3)** Repeating the ID\n  generation calls with the *same* arguments will yield *different* IDs. **(4)** After calling\n  `create_rnd_id.rnd.reset()` and feeding `create_rnd_id` with the *same* user-specific inputs, we can still\n  see the identical *same* IDs generated—which is great for testing.\n\n      create_rnd_id = CND.get_create_rnd_id 1234, 87.23\n\n      # three different user IDs:\n      log create_rnd_id [ 'foo@example.com' ], 12\n      log create_rnd_id [ 'alice@nosuchname.com' ], 12\n      log create_rnd_id [ 'tim@cern.ch' ], 12\n\n      # the same repeated, but yielding random other IDs:\n      log()\n      log create_rnd_id [ 'foo@example.com' ], 12\n      log create_rnd_id [ 'alice@nosuchname.com' ], 12\n      log create_rnd_id [ 'tim@cern.ch' ], 12\n\n      # the same repeated, but yielding the same IDs as in the first run:\n      log()\n      create_rnd_id.rnd.reset()\n      log create_rnd_id [ 'foo@example.com' ], 12\n      log create_rnd_id [ 'alice@nosuchname.com' ], 12\n      log create_rnd_id [ 'tim@cern.ch' ], 12\n\n  The output you should see is\n\n      c40f774fce65\n      9d44f31f9a55\n      1b26e6e3e736\n\n      a0e11f616685\n      d7242f6935c7\n      976f26d1b25b\n\n      c40f774fce65\n      9d44f31f9a55\n      1b26e6e3e736\n\n  Note the last three IDs exactly match the first three IDs. The upshot of this is that we get reasonably\n  hard-to-guess, yet on-demand replayable IDs. Apart from weaknesses in the PRNG itself (for which see the\n  caveats in the description to `get_rnd`), the obvious way to cheat the system is by making it so that\n  a given piece of case-specific data is fed into the ID generator as the n-th call a second time. In\n  theory, we could make it so that each call constributes to the state change inside of `create_rnd_id`;\n  a replay would then need to provide all of the case-specific pieces of data a second time, in the right\n  order. ###\n  #.........................................................................................................\n  R = ( values, length ) =>\n    values.push R.rnd()\n    return @create_id values, length\n  #.........................................................................................................\n  R.rnd = @get_rnd seed, delta\n  #.........................................................................................................\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@id_from_text = ( text, length ) ->\n  ### Given a `text` and a `length`, return an ID with `length` hexadecimal digits (`[0-9a-f]`)—this is like\n  `create_id`, but working on a text rather than a number of arbitrary values. The hash algorithm currently\n  used is SHA-1, which returns 40 hex digits; it should be good enough for the task at hand and has the\n  advantage of being widely implemented. ###\n  ### TAINT should be a user option, or take 'good' algorithm universally available ###\n  R = ( ( ( require 'crypto' ).createHash 'sha1' ).update text, 'utf-8' ).digest 'hex'\n  return if length? then R[ 0 ... length ] else R\n\n#-----------------------------------------------------------------------------------------------------------\n@id_from_route = ( route, length, handler ) ->\n  ### Like `id_from_text`, but accepting a file route instead of a text. ###\n  throw new Error \"asynchronous `id_from_route` not yet supported\" if handler?\n  content = njs_fs.readFileSync route\n  R       = ( ( ( require 'crypto' ).createHash 'sha1' ).update content ).digest 'hex'\n  return if length? then R[ 0 ... length ] else R\n\n\n#===========================================================================================================\n# APP INFO\n#-----------------------------------------------------------------------------------------------------------\n@get_app_home = ( routes = null ) ->\n  ### Return the file system route to the current (likely) application folder. This works by traversing all\n  the routes in `require[ 'main' ][ 'paths' ]` and checking whether one of the `node_modules` folders\n  listed there exists and is a folder; the first match is accepted and returned. If no matching existing\n  route is found, an error is thrown.\n\n  NB that the algorithm works even if the CoffeeNode Options module has been symlinked from another location\n  (rather than 'physically' installed) and even if the application main file has been executed from outside\n  the application folder (i.e. this obviates the need to `cd ~/route/to/my/app` before doing `node ./start`\n  or whatever—you can simply do `node ~/route/to/my/app/start`), but it does presuppose that (1) there *is*\n  a `node_modules` folder in your app folder; (2) there is *no* `node_modules` folder in the subfolder or\n  any of the intervening levels (if any) that contains your startup file. Most modules that follow the\n  established NodeJS / npm way of structuring modules should naturally comply with these assumptions. ###\n  njs_fs = require 'fs'\n  routes ?= require[ 'main' ][ 'paths' ]\n  #.........................................................................................................\n  for route in routes\n    try\n      return njs_path.dirname route if ( njs_fs.statSync route ).isDirectory()\n    #.......................................................................................................\n    catch error\n      ### silently ignore missing routes: ###\n      continue if error[ 'code' ] is 'ENOENT'\n      throw error\n  #.........................................................................................................\n  throw new Error \"unable to determine application home; tested routes: \\n\\n #{routes.join '\\n '}\\n\"\n\n#===========================================================================================================\n# FS ROUTES\n#-----------------------------------------------------------------------------------------------------------\n@swap_extension = ( route, extension ) ->\n  extension = '.' + extension unless extension[ 0 ] is '.'\n  extname   = njs_path.extname route\n  return route[ 0 ... route.length - extname.length ] + extension\n\n#===========================================================================================================\n# LISTS\n#-----------------------------------------------------------------------------------------------------------\n@first_of   = ( collection ) -> collection[ 0 ]\n@last_of    = ( collection ) -> collection[ collection.length - 1 ]\n\n\n\n#===========================================================================================================\n# OBJECT SIZES\n#-----------------------------------------------------------------------------------------------------------\n@size_of = ( x, settings ) ->\n  switch type = CND.type_of x\n    when 'list', 'arguments', 'buffer' then return x.length\n    when 'text'\n      switch selector = settings?[ 'count' ] ? 'codeunits'\n        when 'codepoints' then return ( Array.from x ).length\n        when 'codeunits'  then return x.length\n        when 'bytes'      then return Buffer.byteLength x, ( settings?[ 'encoding' ] ? 'utf-8' )\n        else throw new Error \"unknown counting selector #{rpr selector}\"\n    when 'set', 'map'     then return x.size\n  if CND.isa_pod x then return ( Object.keys x ).length\n  throw new Error \"unable to get size of a #{type}\"\n\n\n\n#===========================================================================================================\n# NETWORK\n#-----------------------------------------------------------------------------------------------------------\n@get_local_ips = ->\n  ### thx to http://stackoverflow.com/a/10756441/256361 ###\n  R = []\n  for _, interface_ of ( require 'os' ).networkInterfaces()\n    for description in interface_\n      if description[ 'family' ] is 'IPv4' and not description[ 'internal' ]\n        R.push description[ 'address' ]\n  return R\n\n#===========================================================================================================\n# SETS\n#-----------------------------------------------------------------------------------------------------------\n@is_subset = ( subset, superset ) ->\n  ### `is_subset subset, superset` returns whether `subset` is a subset of `superset`; this is true if each\n  element of `subset` is also an element of `superset`. ###\n  type_of_sub   = CND.type_of subset\n  type_of_super = CND.type_of superset\n  unless type_of_sub is type_of_super\n    throw new Error \"expected two arguments of same type, got #{type_of_sub} and #{type_of_super}\"\n  switch type_of_sub\n    when 'list'\n      return false unless subset.length <= superset.length\n      for element in subset\n        return false unless element in superset\n      return true\n    when 'set'\n      return false unless subset.size <= superset.size\n      iterator = subset.values()\n      loop\n        { value, done, } = iterator.next()\n        return true if done\n        return false unless superset.has value\n      # for element in\n      #   return false unless element in subset\n      return true\n    else\n      throw new Error \"expected lists or sets, got #{type_of_sub} and #{type_of_super}\"\n  return null\n\n\n#===========================================================================================================\n# ERROR HANDLING\n#-----------------------------------------------------------------------------------------------------------\n@run = ( method, on_error = null, on_after_error = null ) ->\n  ### Provide asynchronous error handling and long stacktraces. Usage:\n\n  To run a method, catch all the synchronous and asynchronous errors and print a stacktrace\n  to `process.stderr` (using `console.error`):\n\n  ```coffee\n  CND.run -> f 42\n  ```\n\n  Same as the above, but do the error handling yourself:\n\n  ```coffee\n  CND.run ( -> f 42 ), ( error ) -> foobar()\n  ```\n\n  Same as the last, except have CND output the error's stacktrace and be called back afterwards:\n\n  ```coffee\n  CND.run ( -> f 42 ), null, ( error ) -> foobar()\n  ```\n\n  NB.: `CND.run` may be made configurable in the future; as of now, it is hardwired to use colors\n  and always provide long (cross-event) stack traces. Colors used are blue for NodeJS VM built-ins,\n  green for errors originating from modules installed under `node_modules`, and yellow for everything\n  else.\n\n  ###\n  on_error         ?= ( error ) ->\n    console.error error[ 'stack' ]\n    on_after_error error if on_after_error?\n  trycatch          = require 'trycatch'\n  #.........................................................................................................\n  trycatch_settings =\n    'long-stack-traces': yes\n    'colors':\n      # 'none' or falsy values will omit\n      'node':         'blue',\n      'node_modules': 'green',\n      'default':      'yellow'\n  #.........................................................................................................\n  trycatch.configure trycatch_settings\n  trycatch method, on_error\n  #.........................................................................................................\n  return null\n"
  ]
}